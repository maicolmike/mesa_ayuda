{% extends 'base.html' %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/register.css' %}">
<link rel="stylesheet" href="{% static 'css/configuracion.css' %}">

<style>
    
</style>

<h2>Detalle de requerimiento</h2>
<div class="configuracion">
<table class="table table-bordered table-hover tabla-detalle">
    <thead>
        <tr>
            <th>Id</th>
            <td>{{ requerimiento.id }}</td>
        </tr>
        <tr>
            <th>Titulo</th>
            <td>{{ requerimiento.titulo }}</td>
        </tr>
        <tr>
            <th>Clasificaci칩n</th>
            <td>{{ requerimiento.clasificacion }}</td>
        </tr>
        <tr>
            <th>Sub-Clasificaci칩n</th>
            <td>{{ requerimiento.sub_clasificacion }}</td>
        </tr>
        <tr>
            <th>Agencia</th>
            <td>{{ requerimiento.agencia }}</td>
        </tr>
        <tr>
            <th>Estado</th>
            {% if requerimiento.estado == "ACTIVO" %}
            <td><span class="badge bg-success">{{ requerimiento.estado }}</td>
            {% elif requerimiento.estado == "CERRADO" %}
            <td><span class="badge bg-danger">{{ requerimiento.estado }}</td>
            {% elif requerimiento.estado == "EN TRAMITE" %}
            <td><span class="badge bg-warning text-dark">{{ requerimiento.estado }}</td>
            {% else %}
            <td><span class="badge bg-info">{{ requerimiento.estado }}</td>
            {% endif %}
        </tr>
        <tr>
            <th>Usuario</th>
            <td>{{ requerimiento.usuario.username }}</td>
        </tr>
        <tr>
            <th>Nombres</th>
            <td>{{ requerimiento.usuario.nombres }}</td>
        </tr>
    </thead>
    <tbody></tbody>
</table>
</div>

<p>
    <a href="{% url 'agregar_novedad' requerimiento.id %}" class="btn btn-info">Agregar novedad</a>
    
    <a href="#" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#modalCerrar{{ requerimiento.id }}">Cerrar caso</a>
    {% include 'requerimientos/modalEliminarRequerimiento.html' %}
    
</p>

<table id="example2" class="table table-bordered table-hover">
    <thead class="table-secondary">
        
        <tr>
            <th>Id</th>
            <th>Fecha</th>
            <th>Descripci칩n</th>
            <th>Adjunto</th>  
            <th>Usuario</th>
            <th>Nombres</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>{{ requerimiento.id }}</td>
            <td>{{ requerimiento.fecha }}</td>
            <td>{{ requerimiento.descripcion}}
                
                {% comment %}
                {{ requerimiento.descripcion|truncatechars:210 }}
                {% if requerimiento.descripcion|length > 210 %}
                    <a href="#" data-bs-toggle="modal" data-bs-target="#modalVerMas{{ requerimiento.id }}">Ver m치s</a>
                    {% include 'requerimientos/modalVerMas.html' with detalle=requerimiento %}
                {% endif %}
                {% endcomment %}

            </td>

            <td class="adjunto">
                {% if requerimiento.adjunto %}
                    <a href="{{ requerimiento.adjunto.url }}" target="_blank" title="{{ requerimiento.adjunto }}">Adjunto disponible <i class="fas fa-paperclip"></i> </a>
                {% else %}
                    No hay adjunto disponible
                {% endif %}
            </td>
            <td>{{ requerimiento.usuario.username }}</td>
            <td>{{ requerimiento.usuario.nombres }}</td>
        </tr>
        {% for detalle in detalles %}
        <tr>
            <td>{{ detalle.id }}</td>
            <td>{{ detalle.fecha }}</td>
            <td>{{ detalle.comentario }}</td>
            <td>
                {% if detalle.adjunto %}
                    <a href="{{ detalle.adjunto.url }}" target="_blank" title="{{ detalle.adjunto }}">Adjunto disponible <i class="fas fa-paperclip"></i></a>
                {% else %}
                    No hay adjunto disponible
                {% endif %}
            </td>
            <td>{{ detalle.usuario.username }}</td>
            <td>{{ detalle.usuario.nombres }}</td>
            {% include 'requerimientos/modalVerMas.html' %}

        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}